/*********************************************************************************/
/********** THIS FILE IS GENERATED BY TOUCHGFX DESIGNER, DO NOT MODIFY ***********/
/*********************************************************************************/
#include <gui_generated/dynamicchartscreen_screen/DynamicChartScreenViewBase.hpp>
#include <touchgfx/Color.hpp>
#include <texts/TextKeysAndLanguages.hpp>
#include <touchgfx/canvas_widget_renderer/CanvasWidgetRenderer.hpp>


DynamicChartScreenViewBase::DynamicChartScreenViewBase() :
    frameCountupdateGraphInterval(0)
{

    touchgfx::CanvasWidgetRenderer::setupBuffer(canvasBuffer, CANVAS_BUFFER_SIZE);

    __background.setPosition(0, 0, 480, 272);
    __background.setColor(touchgfx::Color::getColorFromRGB(0, 0, 0));

    background.setPosition(0, 0, 480, 272);
    background.setColor(touchgfx::Color::getColorFromRGB(0, 0, 0));

    dynamicGraph1.setScale(100);
    dynamicGraph1.setPosition(25, 0, 455, 252);
    dynamicGraph1.setGraphAreaMargin(10, 40, 0, 30);
    dynamicGraph1.setGraphAreaPadding(0, 0, 0, 0);
    dynamicGraph1.setGraphRangeY(0, 100);

    dynamicGraph1MajorXAxisGrid.setScale(100);
    dynamicGraph1MajorXAxisGrid.setColor(touchgfx::Color::getColorFromRGB(20, 151, 197));
    dynamicGraph1MajorXAxisGrid.setInterval(400);
    dynamicGraph1MajorXAxisGrid.setLineWidth(1);
    dynamicGraph1.addGraphElement(dynamicGraph1MajorXAxisGrid);

    dynamicGraph1MajorYAxisGrid.setScale(100);
    dynamicGraph1MajorYAxisGrid.setColor(touchgfx::Color::getColorFromRGB(20, 151, 197));
    dynamicGraph1MajorYAxisGrid.setInterval(10);
    dynamicGraph1MajorYAxisGrid.setLineWidth(1);
    dynamicGraph1.addGraphElement(dynamicGraph1MajorYAxisGrid);

    dynamicGraph1MajorXAxisLabel.setScale(100);
    dynamicGraph1MajorXAxisLabel.setInterval(400);
    dynamicGraph1MajorXAxisLabel.setLabelTypedText(touchgfx::TypedText(T___SINGLEUSE_J5XF));
    dynamicGraph1MajorXAxisLabel.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    dynamicGraph1.addBottomElement(dynamicGraph1MajorXAxisLabel);

    dynamicGraph1MajorYAxisLabel.setScale(100);
    dynamicGraph1MajorYAxisLabel.setInterval(10);
    dynamicGraph1MajorYAxisLabel.setLabelTypedText(touchgfx::TypedText(T___SINGLEUSE_U26F));
    dynamicGraph1MajorYAxisLabel.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    dynamicGraph1.addLeftElement(dynamicGraph1MajorYAxisLabel);

    dynamicGraph1Line1Painter.setColor(touchgfx::Color::getColorFromRGB(196, 22, 22));
    dynamicGraph1Line1.setPainter(dynamicGraph1Line1Painter);
    dynamicGraph1Line1.setLineWidth(4);
    dynamicGraph1.addGraphElement(dynamicGraph1Line1);

    xlabel.setXY(182, 248);
    xlabel.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    xlabel.setLinespacing(0);
    xlabel.setTypedText(touchgfx::TypedText(T___SINGLEUSE_MCJT));

    ylabel.setXY(7, 67);
    ylabel.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    ylabel.setLinespacing(0);
    ylabel.setRotation(touchgfx::TEXT_ROTATE_270);
    ylabel.setTypedText(touchgfx::TypedText(T___SINGLEUSE_VSWH));

    add(__background);
    add(background);
    add(dynamicGraph1);
    add(xlabel);
    add(ylabel);
}

void DynamicChartScreenViewBase::setupScreen()
{

}

//Handles tick based events
void DynamicChartScreenViewBase::handleTickEvent()
{
    frameCountupdateGraphInterval++;
    if(frameCountupdateGraphInterval == TICK_UPDATEGRAPH_INTERVAL)
    {
        //updateGraph
        //When every N tick execute C++ code
        //Execute C++ code
        // Add data point
        float time_s = __HAL_TIM_GET_COUNTER(&htim2) / 1000000.0f;
        float signal_u = 40 * sinf(2*M_PI*0.05f*time_s) + 50;
        
        dynamicGraph1.addDataPoint(signal_u);
        frameCountupdateGraphInterval = 0;
    }

}
